@use "sass:list";
@use "sass:map";
@use "variables" as *;

// Generate CSS Variables from Color Map
@mixin generate-color-variables($color-map) {
  :root {
    @each $name, $value in $color-map {
      --color-#{$name}: #{$value};
    }
  }
}

// Responsive media mixin
// Usage:
//   @include media(md)            // < md (max-width)
//   @include media("<", md)       // < md
//   @include media("<= ", lg)     // <= lg (alias of < lg)
//   @include media(">=", lg)      // >= lg (min-width)
//   @include media(">", md)       // > md  (min-width just above md)
@mixin media($arg1, $arg2: null) {
  $op: "<"; // default to "less than"
  $bp: $arg1;

  @if $arg2 != null {
    $op: $arg1;
    $bp: $arg2;
  }

  $bp-value: map.get($breakpoints, $bp);

  @if $bp-value == null {
    @error "Unknown breakpoint `#{$bp}`. Check `$breakpoints` map.";
  }

  @if $op == "<" or $op == "<=" {
    @media (max-width: $bp-value) {
      @content;
    }
  } @else if $op == ">=" {
    @media (min-width: $bp-value) {
      @content;
    }
  } @else if $op == ">" {
    // 1px above the breakpoint to avoid overlap with "<=" range
    @media (min-width: $bp-value + 1px) {
      @content;
    }
  } @else {
    @error "Unsupported media operator `#{$op}`. Use '<', '<=', '>', '>='.";
  }
}

// Mixin to generate responsive heading CSS variables at :root
@mixin generate-heading-vars($map) {
  // Base (desktop)
  :root {
    @each $name, $sizes in $map {
      $desktop-size: list.nth($sizes, 1);
      --#{$name}: #{$desktop-size};
    }
  }
  // Tablet (less than lg)
  @include media(lg) {
    :root {
      @each $name, $sizes in $map {
        $tablet-size: list.nth($sizes, 2);
        --#{$name}: #{$tablet-size};
      }
    }
  }
  // Mobile (less than md)
  @include media(md) {
    :root {
      @each $name, $sizes in $map {
        $mobile-size: list.nth($sizes, 3);
        --#{$name}: #{$mobile-size};
      }
    }
  }
}

// Input placeholder styling helper
// Usage:
// input {
//   @include placeholder {
//     color: #999;
//     font-style: italic;
//     opacity: 0.7;
//   }
// }
// For focus state: &:focus { @include placeholder { color: #666; } }
@mixin placeholder {
  $selector: &;

  @at-root {
    #{$selector}::placeholder {
      @content;
    }
    #{$selector}::-webkit-input-placeholder {
      @content;
    }
    #{$selector}:-ms-input-placeholder {
      @content;
    }
  }
}

// Custom scrollbar styling mixin
// Provides cross-browser scrollbar customization (WebKit browsers + Firefox)
// Usage:
//   .dropdown {
//     height: 400px;
//     overflow-y: auto;
//     @include custom-scrollbar();
//   }
// With custom values:
//   @include custom-scrollbar(10px, var(--color-gray-500), var(--color-gray-200));
// Parameters:
//   $width: Scrollbar width (default: 12px)
//   $thumb-color: Scrollbar thumb color (default: var(--color-gray-400))
//   $track-color: Scrollbar track color (default: var(--color-gray-100))
//   $thumb-hover: Thumb color on hover (optional, uses opacity filter if not provided)
// Note: Firefox has limited customization (only width and colors)
@mixin custom-scrollbar(
  $width: 12px,
  $thumb-color: var(--color-gray-400),
  $track-color: var(--color-gray-100),
  $thumb-hover: null
) {
  // Firefox scrollbar styling
  scrollbar-width: thin;
  scrollbar-color: $thumb-color $track-color;

  // WebKit browsers (Chrome, Safari, Edge, Opera)
  &::-webkit-scrollbar {
    width: $width;
    height: $width; // For horizontal scrollbars
  }

  &::-webkit-scrollbar-track {
    background: $track-color;
    border-radius: calc($width / 2);
  }

  &::-webkit-scrollbar-thumb {
    background-color: $thumb-color;
    border-radius: calc($width / 2);
    border: 2px solid $track-color; // Creates padding effect

    @if $thumb-hover {
      &:hover {
        background-color: $thumb-hover;
      }

      &:active {
        background-color: $thumb-hover;
        opacity: 0.8;
      }
    } @else {
      &:hover {
        opacity: 0.85;
      }

      &:active {
        opacity: 0.7;
      }
    }
  }

  // Optional: Style scrollbar corner (where vertical and horizontal meet)
  &::-webkit-scrollbar-corner {
    background: $track-color;
  }
}
